tool: nsys

service:
  type: NodePort
  nodeHttpPort: 30080
  nodeTurnPort: 30478

webUsername: nvidia
webPassword: nvidia

# Pin to a node with a routable ExternalIP and keep HOST_IP stable for TURN.
nodeSelector:
  kubernetes.io/hostname: noumena01-cpu-02

env:
  - name: HOST_IP
    value: "192.222.55.227"
  # Allow the Nsight Systems UI (inside the streamer container) to control
  # injected profiling sessions via the in-cluster coordinator (no SSH).
  - name: NSYS_FEATURE_CURVE_ENCRYPTION
    value: "1"
  - name: NSYS_COORDINATOR_ANNOUNCE_ADDRESS
    value: "tcp://nsight-operator-coordinator.nsight.svc.cluster.local:13001"
  - name: NSYS_COORDINATOR_COMMAND_ADDRESS
    value: "tcp://nsight-operator-coordinator.nsight.svc.cluster.local:13002"
  - name: NSYS_COORDINATOR_CONNECTION_KEY
    valueFrom:
      secretKeyRef:
        name: nsight-operator-coordinator-curve-keys
        key: curve_public
        optional: true
  - name: NSYS_COORDINATOR_CURVE_PUBLIC
    valueFrom:
      secretKeyRef:
        name: nsight-operator-coordinator-client-curve-keys
        key: curve_public
        optional: true
  - name: NSYS_COORDINATOR_CURVE_PRIVATE
    valueFrom:
      secretKeyRef:
        name: nsight-operator-coordinator-client-curve-keys
        key: curve_private
        optional: true

volumes:
  - name: supervisord
    configMap:
      name: nsight-streamer-supervisord
      items:
        - key: supervisord.conf
          path: supervisord.conf

volumeMounts:
  - name: supervisord
    mountPath: /etc/webrtc/supervisord.conf
    subPath: supervisord.conf
