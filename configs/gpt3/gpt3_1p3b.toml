# GPT-3 XL (1.3B) — Table 2.1 / Appendix B (arXiv:2005.14165v4)
#
# See `configs/gpt3/gpt3_125m.toml` for mapping notes.

preset = "gpt3"
experiment_id = "gpt3_1p3b"

tokenizer = "gpt2"
vocab_size = 50304
eos_token_id = 50256
loss_mask_eos = false

data_path = "/data/fineweb10B_gpt2_npy/train"
validation_enabled = true
validation_data_path = "/data/fineweb10B_gpt2_npy/valid"
validation_every = 2000
validation_steps = 5

# Model (GPT-3 1.3B)
dim = 2048
n_layers = 24
n_heads = 16
inter_dim = 8192
n_dense_layers = 24

attn = "sdpa"

dtype = "bf16"
seq_len = 2048

# ~1.0M tokens/update (paper) → 512 * 2048 = 1,048,576
batch_size = 512
steps = 286103

use_muon = false
lr_dense = 2.0e-4
lr_router = 2.0e-4
lr_expert = 2.0e-4
weight_decay = 0.1
adam_beta1 = 0.9
adam_beta2 = 0.95
adam_eps = 1e-8

warmup_steps = 358
hold_tokens = 0
decay_tokens = 260_000_000_000
decay_floor = 2.0e-5
